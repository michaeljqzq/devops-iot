{
  "id": "ArchiveAndPublishArtifacts",
  "name": "Archive and Publish artifacts",
  "category": "Build",
  "iconTaskId": "2ff763a7-ce83-4e1f-bc89-0ae63477cebe",
  "description": "Archive and Publish artifacts from source repository",
  "template": {
    "buildNumberFormat": "$(date:yyyyMMdd)$(rev:.r)",
    "process": {
      "type": 1,
      "phases": [
        {
          "steps": [
            {
              "enabled": true,
              "continueOnError": false,
              "alwaysRun": false,
              "timeoutInMinutes": 0,
              "displayName": "Archive files",
              "inputs": {
                "rootFolder": "$(System.DefaultWorkingDirectory)/app",
                "includeRootFolder": "false",
                "archiveType": "zip",
                "tarCompression": "none",
                "archiveFile": "$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip",
                "replaceExistingArchive": "true"
              },
              "task": {
                "id": "d8b84976-e99a-4b86-b885-4849694435b0",
                "versionSpec": "1.*",
                "definitionType": "task"
              }
            },
            {
              "enabled": true,
              "continueOnError": false,
              "alwaysRun": false,
              "displayName": "Copy ARM templates",
              "timeoutInMinutes": 0,
              "task": {
                "id": "5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c",
                "versionSpec": "2.*",
                "definitionType": "task"
              },
              "inputs": {
                "SourceFolder": "armTemplates",
                "Contents": "**",
                "TargetFolder": "$(build.artifactstagingdirectory)",
                "CleanTargetFolder": "false",
                "OverWrite": "false",
                "flattenFolders": "false"
              }
            },
            {
              "enabled": true,
              "continueOnError": false,
              "alwaysRun": false,
              "timeoutInMinutes": 0,
              "displayName": "Publish Artifact: drop",
              "inputs": {
                "PathtoPublish": "$(Build.ArtifactStagingDirectory)",
                "ArtifactName": "drop",
                "ArtifactType": "Container",
                "TargetPath": "\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)",
                "Parallel": "false",
                "ParallelCount": "8"
              },
              "task": {
                "id": "2ff763a7-ce83-4e1f-bc89-0ae63477cebe",
                "versionSpec": "1.*",
                "definitionType": "task"

              }
            }
          ]
        }
      ]
    },
    "options": [],
    "variables": {
      "system.debug": {
        "value": "false",
        "allowOverride": true,
        "isSecret": false
      },
      "BuildConfiguration": {
        "value": "release",
        "allowOverride": true
      },
      "BuildPlatform": {
        "value": "any cpu",
        "allowOverride": true
      }
    },
    "triggers": []
  }
}